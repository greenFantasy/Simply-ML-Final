{"ast":null,"code":"import { HalfPi, Tau } from '../util/constants';\nvar bounds,\n    circleThreshold = Tau - 1e-8;\nexport default function context(_) {\n  bounds = _;\n  return context;\n}\n\nfunction noop() {}\n\nfunction add(x, y) {\n  bounds.add(x, y);\n}\n\ncontext.beginPath = noop;\ncontext.closePath = noop;\ncontext.moveTo = add;\ncontext.lineTo = add;\n\ncontext.rect = function (x, y, w, h) {\n  add(x, y);\n  add(x + w, y + h);\n};\n\ncontext.quadraticCurveTo = function (x1, y1, x2, y2) {\n  add(x1, y1);\n  add(x2, y2);\n};\n\ncontext.bezierCurveTo = function (x1, y1, x2, y2, x3, y3) {\n  add(x1, y1);\n  add(x2, y2);\n  add(x3, y3);\n};\n\ncontext.arc = function (cx, cy, r, sa, ea, ccw) {\n  if (Math.abs(ea - sa) > circleThreshold) {\n    add(cx - r, cy - r);\n    add(cx + r, cy + r);\n    return;\n  }\n\n  var xmin = Infinity,\n      xmax = -Infinity,\n      ymin = Infinity,\n      ymax = -Infinity,\n      s,\n      i,\n      x,\n      y;\n\n  function update(a) {\n    x = r * Math.cos(a);\n    y = r * Math.sin(a);\n    if (x < xmin) xmin = x;\n    if (x > xmax) xmax = x;\n    if (y < ymin) ymin = y;\n    if (y > ymax) ymax = y;\n  } // Sample end points and interior points aligned with 90 degrees\n\n\n  update(sa);\n  update(ea);\n\n  if (ea !== sa) {\n    sa = sa % Tau;\n    if (sa < 0) sa += Tau;\n    ea = ea % Tau;\n    if (ea < 0) ea += Tau;\n\n    if (ea < sa) {\n      ccw = !ccw; // flip direction\n\n      s = sa;\n      sa = ea;\n      ea = s; // swap end-points\n    }\n\n    if (ccw) {\n      ea -= Tau;\n      s = sa - sa % HalfPi;\n\n      for (i = 0; i < 4 && s > ea; ++i, s -= HalfPi) update(s);\n    } else {\n      s = sa - sa % HalfPi + HalfPi;\n\n      for (i = 0; i < 4 && s < ea; ++i, s = s + HalfPi) update(s);\n    }\n  }\n\n  add(cx + xmin, cy + ymin);\n  add(cx + xmax, cy + ymax);\n};","map":null,"metadata":{},"sourceType":"module"}