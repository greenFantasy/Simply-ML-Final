{"ast":null,"code":"import { merge } from 'vega-util';\nexport default function (idFunc, source, input) {\n  var $ = idFunc,\n      data = source || [],\n      add = input || [],\n      rem = {},\n      cnt = 0;\n  return {\n    add: function (t) {\n      add.push(t);\n    },\n    remove: function (t) {\n      rem[$(t)] = ++cnt;\n    },\n    size: function () {\n      return data.length;\n    },\n    data: function (compare, resort) {\n      if (cnt) {\n        data = data.filter(function (t) {\n          return !rem[$(t)];\n        });\n        rem = {};\n        cnt = 0;\n      }\n\n      if (resort && compare) {\n        data.sort(compare);\n      }\n\n      if (add.length) {\n        data = compare ? merge(compare, data, add.sort(compare)) : data.concat(add);\n        add = [];\n      }\n\n      return data;\n    }\n  };\n}","map":null,"metadata":{},"sourceType":"module"}