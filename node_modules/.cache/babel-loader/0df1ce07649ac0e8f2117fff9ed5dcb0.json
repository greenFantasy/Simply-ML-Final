{"ast":null,"code":"import { Symbols, Discrete } from './legend-types';\nimport { tickFormat, tickValues } from './ticks';\nimport { Quantile, Quantize, Threshold, tickFormat as spanFormat, Time } from 'vega-scale';\nimport { peek } from 'vega-util';\nconst symbols = {\n  [Quantile]: 'quantiles',\n  [Quantize]: 'thresholds',\n  [Threshold]: 'domain'\n};\nconst formats = {\n  [Quantile]: 'quantiles',\n  [Quantize]: 'domain'\n};\nexport function labelValues(scale, count) {\n  return scale.bins ? binValues(scale.bins) : symbols[scale.type] ? thresholdValues(scale[symbols[scale.type]]()) : tickValues(scale, count);\n}\nexport function thresholdFormat(scale, specifier) {\n  var _ = scale[formats[scale.type]](),\n      n = _.length,\n      d = n > 1 ? _[1] - _[0] : _[0],\n      i;\n\n  for (i = 1; i < n; ++i) {\n    d = Math.min(d, _[i] - _[i - 1]);\n  } // 3 ticks times 10 for increased resolution\n\n\n  return spanFormat(0, d, 3 * 10, specifier);\n}\n\nfunction thresholdValues(thresholds) {\n  const values = [-Infinity].concat(thresholds);\n  values.max = +Infinity;\n  return values;\n}\n\nfunction binValues(bins) {\n  const values = bins.slice(0, -1);\n  values.max = peek(bins);\n  return values;\n}\n\nfunction isDiscreteRange(scale) {\n  return symbols[scale.type] || scale.bins;\n}\n\nexport function labelFormat(scale, count, type, specifier, formatType) {\n  const format = formats[scale.type] && formatType !== Time ? thresholdFormat(scale, specifier) : tickFormat(scale, count, specifier, formatType);\n  return type === Symbols && isDiscreteRange(scale) ? formatRange(format) : type === Discrete ? formatDiscrete(format) : formatPoint(format);\n}\n\nfunction formatRange(format) {\n  return function (value, index, array) {\n    var limit = array[index + 1] || array.max || +Infinity,\n        lo = formatValue(value, format),\n        hi = formatValue(limit, format);\n    return lo && hi ? lo + '\\u2013' + hi : hi ? '< ' + hi : '\\u2265 ' + lo;\n  };\n}\n\nfunction formatDiscrete(format) {\n  return function (value, index) {\n    return index ? format(value) : null;\n  };\n}\n\nfunction formatPoint(format) {\n  return function (value) {\n    return format(value);\n  };\n}\n\nfunction formatValue(value, format) {\n  return Number.isFinite(value) ? format(value) : null;\n}\n\nexport function labelFraction(scale) {\n  var domain = scale.domain(),\n      count = domain.length - 1,\n      lo = +domain[0],\n      hi = +peek(domain),\n      span = hi - lo;\n\n  if (scale.type === Threshold) {\n    var adjust = count ? span / count : 0.1;\n    lo -= adjust;\n    hi += adjust;\n    span = hi - lo;\n  }\n\n  return function (value) {\n    return (value - lo) / span;\n  };\n}","map":null,"metadata":{},"sourceType":"module"}